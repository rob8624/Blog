{% extends "base.html" %}
{% load wagtailcore_tags %}
{% load wagtailcore_tags snippet_tags %}
{% load wagtailimages_tags %}
{% load wagtailimages_tags wagtailcore_tags %}
{% load wagtailroutablepage_tags %}
{% block body_class %}template-homepage{% endblock %}
{% block content %}
  <!-- 
Install the "flowbite-typography" NPM package to apply styles and format the article content: 

URL: https://flowbite.com/docs/components/typography/ 
-->
  <!--Wrapper for detail page-->
  <div></div>
  <div _="" id="result" class="hidden lg:flex flex-col fixed">
    <div  class="text-lg font-bold">Table of Contents</div>
  </div>
  
    <div class="m-7 sm:container mx-auto lg:px-64 relative  " hx-boost="true">
      <div class="flex flex-col items-center bg-gradient-to-b  from-slate-100 to-white">
        {% for block in page.content %}
          {% if block.block_type == 'title_and_text' %}
            <div class="mt-10 pb-5">
              <h6 class="text-6xl font-sans text-black text-center font-bold">{{ block.value.title }}</h6>
            </div>
            <div class="inline-flex pt-2 pl-10 gap-1 flex-wrap">
              {% for author in self.blog_authors.all %}
                {% if author.author.image %}
                  {% image author.author.image width-100 as photo %}
                  <div class="font-thin text-xs sm:text-base">Article by:</div>
                  <div class="">
                    <img class="w-5 h-5 rounded-full hover:opacity-50"
                         src="{{ photo.url }}"
                         alt="authorimage" />
                  </div>
                {% endif %}
                <div class="text-xs sm:text-base font-bold text-green-700 font-Lato">{{ author.author.name }}</div>
                {% for socials in author.author.author_socials.all %}
                  {% if socials.network == "Github" %}
                    <a href="{{ socials.url }}">
                      <svg class=" w-5 h-5 sm:w-6 sm:h-6 text-green-800"
                           aria-hidden="true"
                           xmlns="http://www.w3.org/2000/svg"
                           fill="currentColor"
                           viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 .333A9.911 9.911 0 0 0 6.866 19.65c.5.092.678-.215.678-.477 0-.237-.01-1.017-.014-1.845-2.757.6-3.338-1.169-3.338-1.169a2.627 2.627 0 0 0-1.1-1.451c-.9-.615.07-.6.07-.6a2.084 2.084 0 0 1 1.518 1.021 2.11 2.11 0 0 0 2.884.823c.044-.503.268-.973.63-1.325-2.2-.25-4.516-1.1-4.516-4.9A3.832 3.832 0 0 1 4.7 7.068a3.56 3.56 0 0 1 .095-2.623s.832-.266 2.726 1.016a9.409 9.409 0 0 1 4.962 0c1.89-1.282 2.717-1.016 2.717-1.016.366.83.402 1.768.1 2.623a3.827 3.827 0 0 1 1.02 2.659c0 3.807-2.319 4.644-4.525 4.889a2.366 2.366 0 0 1 .673 1.834c0 1.326-.012 2.394-.012 2.72 0 .263.18.572.681.475A9.911 9.911 0 0 0 10 .333Z" clip-rule="evenodd" />
                      </svg>
                    </a>
                  {% endif %}
                  {% if socials.network == "Facebook" %}
                    <a href="{{ socials.url }}">
                      <svg class="w-5 h-5 sm:w-6 sm:h-6 fill-blue-900"
                           aria-hidden="true"
                           xmlns="http://www.w3.org/2000/svg"
                           fill="currentColor"
                           viewBox="0 0 8 19">
                        <path fill-rule="evenodd" d="M6.135 3H8V0H6.135a4.147 4.147 0 0 0-4.142 4.142V6H0v3h2v9.938h3V9h2.021l.592-3H5V3.591A.6.6 0 0 1 5.592 3h.543Z" clip-rule="evenodd" />
                      </svg>
                    </a>
                  {% endif %}
                  {% if socials.network == "Twitter" %}
                    <a href="{{ socials.url }}">
                      <svg class="w-5 h-5 sm:w-6 sm:h-6 fill-blue-700"
                           aria-hidden="true"
                           xmlns="http://www.w3.org/2000/svg"
                           fill=""
                           viewBox="0 0 20 17">
                        <path fill-rule="evenodd" d="M20 1.892a8.178 8.178 0 0 1-2.355.635 4.074 4.074 0 0 0 1.8-2.235 8.344 8.344 0 0 1-2.605.98A4.13 4.13 0 0 0 13.85 0a4.068 4.068 0 0 0-4.1 4.038 4 4 0 0 0 .105.919A11.705 11.705 0 0 1 1.4.734a4.006 4.006 0 0 0 1.268 5.392 4.165 4.165 0 0 1-1.859-.5v.05A4.057 4.057 0 0 0 4.1 9.635a4.19 4.19 0 0 1-1.856.07 4.108 4.108 0 0 0 3.831 2.807A8.36 8.36 0 0 1 0 14.184 11.732 11.732 0 0 0 6.291 16 11.502 11.502 0 0 0 17.964 4.5c0-.177 0-.35-.012-.523A8.143 8.143 0 0 0 20 1.892Z" clip-rule="evenodd" />
                      </svg>
                    </a>
                  {% endif %}
                {% endfor %}
                <div class="inline-block text-xs sm:text-base">{{ self.last_published_at|date:"F d, Y" }}</div>
              </div>
            {% endfor %}
            <div class="inline-flex pl-10 sm:pl-0 gap-1 flex-wrap">
              {% with categories=page.categories.all %}
                {% if categories %}
                  {% for category in categories %}
                    <div class="bg-blue-200 text-yellow-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-yellow-900 dark:text-yellow-300">
                      {{ category.name }}
                    </div>
                  {% endfor %}
                {% endif %}
              {% endwith %}
              <div class="text-xs">clicktag:</div>
              {% if page.tags.count %}
                {% for tag in page.tags.all %}
                  <div>
                    <a hx-boost="true"
                       href="{% routablepageurl page.get_parent.specific 'post_by_tag' tag %}"
                       hx-target="#clicktags"
                       hx-swap='innerHTML show:no-scroll'
                       hx-push-url="false"
                       class="bg-yellow-100 text-yellow-800 text-sm font-medium mr-2 px-2.5 py-0.5 rounded dark:bg-yellow-900 dark:text-yellow-300">
                    {{ tag }}</a>
                  </div>
                {% endfor %}
              {% endif %}
            </div>
            <div id="clicktags" class="flex-row self-start"></div>
            <hr />
            <p class="text-lg text-black font-Poppins  text-center pt-5 font-thin">{{ block.value.text }}</p>
          {% endif %}
        {% endfor %}
      </div>
      <!--Main blog image-->
      <hr>
      <!--Wrapper for content-->
        <div class="flex flex-col items-center">
          <!--Author-->
        
        <!--Tags-->
        {% image self.blog_image width-1200 as banner %}
        <div class="flex justify-center drop-shadow-xl border-x-lime-300 pt-10">
          <img class="shadow-2xl rounded-lg" src="{{ banner.url }}" />
        </div>
        <!--Streamfeild content-->
        {% for block in page.content %}
          {% if block.block_type == 'embed' %}
            <div class="relative min-w-full" style="padding-top: 56.25%">
              <iframe class="absolute inset-0 w-full h-full p-10"
                      src="{{ block.value.embed.url |embedurl }}"
                      frameborder="0"></iframe>
            </div>
          {% endif %}
          
          <section class="block-{{ block.block_type }}">
            <div id="content-block" _="
            init 
            set items to the <h2/> in me 
              for item in items index i
                
                set {id:'heading-' + i} on item then 
                  if item.textContent == ''  remove it else
                  add .scroll-mt-40 to item 
                  put `<a _='on click remove .bg-green-200 from .link-status then add bg-gradient-to-r .from-yellow-200 to me'
                  class='link-text-${i} link-status hover:bg-gradient-to-r
                  from-green-100 to-white text-base font-sans active:bg-green-500' 
                  href=#${item.id}>${item.innerText}</a>` 
                               
                              at the end of the #result then set text to item.textContent 


                                    
                            
                        
                      for s in items set it's @_ to '
                      on scroll from the window set x to my.getBoundingClientRect().top log x then set text to my.textContent 
                    
                    if x > 50 and x < 300 set links to the <a/> in #result 
                    for test in links
                   
                    if test.textContent contains text add .bg-gradient-to-r .from-yellow-200 to it else remove .bg-gradient-to-r .from-yellow-200 from it 
                    ' end 
                        
                    "
                    
                    class="items-center prose max-w-full mb-0 lg:prose-xl wagtail-richtext p-2 sm:p-0">{% include_block block %}</div>
          </section>
        {% endfor %}
        </div>
    </div>
  </div>
{% endblock %}
</div>
